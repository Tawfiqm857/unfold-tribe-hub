import{o as v,r as i,h as H,w as _,x as u,j as e,n as O,s as A,p as C,B as r,_ as f,l as j}from"./index-D6oOpJz6.js";import{C as k,c as z}from"./card-bNXMIAJA.js";import{D as T,b as B,c as P,d as U}from"./dialog-BQvMVaKK.js";import{L as x}from"./label-D7IAa9nh.js";import{T as G}from"./textarea-DXRlQ9lW.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=v("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=v("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=v("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),X=()=>{const[a,N]=i.useState([]),[d,S]=i.useState(null),[R,D]=i.useState(!0),[E,o]=i.useState(!1),[b,y]=i.useState(!1),[m,p]=i.useState(null),{user:t,isAuthenticated:M}=H(),[n,g]=i.useState({magazine_id:"",full_name:"",email:"",phone_number:"",delivery_address:""});i.useEffect(()=>{L()},[]);const L=async()=>{try{const{data:s,error:l}=await _.from("magazines").select("*").order("publication_date",{ascending:!1});if(l)throw l;if(!s||s.length===0){const c={id:"fallback",title:"Unfold Editorial",description:"A curated editorial experience from Unfold Tribe Nigeria.",issue_number:"Issue 1",cover_image_url:null,publication_date:null,embed_url:"https://tawfiqm857.github.io/unfold-editorial-web/",tags:["Nigeria","Editorial"],created_at:new Date().toISOString()};N([c])}else N(s)}catch(s){u({title:"Error loading magazines",description:s.message,variant:"destructive"})}finally{D(!1)}},w=s=>{if(!M){u({title:"Login required",description:"Please login to request a hard copy",variant:"destructive"});return}S(s),g(l=>({...l,magazine_id:s.id,full_name:(t==null?void 0:t.fullName)||"",email:(t==null?void 0:t.email)||""})),o(!0)},I=async s=>{s.preventDefault(),y(!0);try{const{error:l}=await _.from("hard_copy_requests").insert([{...n,user_id:t==null?void 0:t.id}]);if(l)throw l;u({title:"Request submitted successfully!",description:`Your request for "${d==null?void 0:d.title}" has been received. We'll contact you soon with delivery details.`}),o(!1),g({magazine_id:"",full_name:"",email:"",phone_number:"",delivery_address:""})}catch(l){u({title:"Request failed",description:l.message,variant:"destructive"})}finally{y(!1)}},h=(s,l)=>{g(c=>({...c,[s]:l}))},F=s=>s?new Date(s).toLocaleDateString("en-NG",{year:"numeric",month:"long",day:"numeric"}):"N/A";return R?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(O,{className:"w-8 h-8 animate-spin"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-hero bg-clip-text text-transparent mb-4",children:"Nigerian Digital Magazines"}),e.jsx("p",{className:"text-muted-foreground text-lg max-w-2xl mx-auto",children:"Explore innovative content from Nigeria's brightest entrepreneurs, creatives, and thought leaders. Read online or request a physical copy delivered to your doorstep."})]}),a.length>0&&e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Featured Magazine"}),e.jsx(k,{className:"overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsx("div",{className:"aspect-[3/4] overflow-hidden rounded-lg",children:e.jsx("img",{src:a[0].cover_image_url||"https://images.unsplash.com/photo-1586953208448-b95a79798f07?w=400&h=600&fit=crop",alt:a[0].title,loading:"lazy",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:a[0].title}),e.jsx("p",{className:"text-muted-foreground",children:a[0].issue_number})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsxs("span",{children:["Published: ",F(a[0].publication_date)]})]}),a[0].description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a[0].description}),a[0].tags&&a[0].tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:a[0].tags.map((s,l)=>e.jsxs(C,{variant:"secondary",className:"text-xs",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),s]},l))}),e.jsxs("div",{className:"flex flex-col gap-3 pt-4",children:[e.jsxs(r,{onClick:()=>p(m===a[0].id?null:a[0].id),className:"w-full",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),m===a[0].id?"Hide Magazine":"Read Online"]}),e.jsxs(r,{variant:"outline",onClick:()=>w(a[0]),className:"w-full",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Request Hard Copy"]}),e.jsxs(r,{variant:"ghost",onClick:()=>window.open(a[0].embed_url,"_blank"),className:"w-full",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Open in New Tab"]})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:m===a[0].id?e.jsx("div",{className:"h-[800px] rounded-lg overflow-hidden border",children:e.jsx("iframe",{src:a[0].embed_url,title:a[0].title,className:"w-full h-full",frameBorder:"0",allowFullScreen:!0})}):e.jsx("div",{className:"h-[800px] rounded-lg border-2 border-dashed border-muted flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(f,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Ready to Read?"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:'Click "Read Online" to view the magazine here'}),e.jsx(r,{onClick:()=>p(a[0].id),children:"Start Reading"})]})})})]})})]}),a.length>1&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"All Magazines"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(s=>e.jsxs(k,{className:"card-hover overflow-hidden",children:[e.jsx("div",{className:"aspect-[3/4] overflow-hidden",children:e.jsx("img",{src:s.cover_image_url||"https://images.unsplash.com/photo-1586953208448-b95a79798f07?w=400&h=600&fit=crop",alt:s.title,loading:"lazy",className:"w-full h-full object-cover transition-transform duration-300 hover:scale-105"})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:s.title}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s.issue_number})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.slice(0,3).map((l,c)=>e.jsx(C,{variant:"secondary",className:"text-xs",children:l},c))}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(r,{size:"sm",className:"flex-1",onClick:()=>p(m===s.id?null:s.id),children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),"Read"]}),e.jsx(r,{size:"sm",variant:"outline",onClick:()=>w(s),children:e.jsx(q,{className:"w-4 h-4"})})]})]})})]},s.id))})]}),e.jsx(T,{open:E,onOpenChange:o,children:e.jsxs(B,{className:"sm:max-w-[500px]",children:[e.jsx(P,{children:e.jsx(U,{children:"Request Hard Copy"})}),d&&e.jsxs("div",{className:"mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-semibold",children:d.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:d.issue_number})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"fullName",children:"Full Name *"}),e.jsx(j,{id:"fullName",value:n.full_name,onChange:s=>h("full_name",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"email",children:"Email Address *"}),e.jsx(j,{id:"email",type:"email",value:n.email,onChange:s=>h("email",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(x,{htmlFor:"phone",children:"Phone Number (Optional)"}),e.jsx(j,{id:"phone",type:"tel",placeholder:"+234 xxx xxx xxxx",value:n.phone_number,onChange:s=>h("phone_number",s.target.value)})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(x,{htmlFor:"address",children:"Delivery Address *"}),e.jsx(G,{id:"address",placeholder:"Please provide your complete delivery address including city and state",value:n.delivery_address,onChange:s=>h("delivery_address",s.target.value),required:!0,rows:3})]})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["ðŸ“¦ ",e.jsx("strong",{children:"Delivery Info:"})," Hard copies are delivered within Lagos for â‚¦2,000, other Nigerian states for â‚¦3,500. International delivery available on request."]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(r,{type:"submit",disabled:b,children:b?"Submitting...":"Submit Request"})]})]})]})})]})};export{X as default};
