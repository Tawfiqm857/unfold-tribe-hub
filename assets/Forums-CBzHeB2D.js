import{o as A,h as D,r as a,j as e,n as L,B as m,l as M,M as f,q as k,A as I,t as P,v as F,w as x,x as o}from"./index-D6oOpJz6.js";import{C as i,c as r,a as N,b as v}from"./card-bNXMIAJA.js";import{D as H,a as V,b as q,c as z,d as E}from"./dialog-BQvMVaKK.js";import{L as y}from"./label-D7IAa9nh.js";import{S as B,a as U,b as G,c as J,d as R}from"./select-Biv_VjXN.js";import{P as W}from"./plus-DSTSTUho.js";import{T as Y}from"./trending-up-C108R449.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=A("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]),te=()=>{const{user:c}=D(),[l,b]=a.useState([]),[h,w]=a.useState([]),[C,T]=a.useState(!0),[p,u]=a.useState(!1),[n,j]=a.useState(""),[d,g]=a.useState(void 0);a.useEffect(()=>{(async()=>{try{const[{data:t},{data:S}]=await Promise.all([x.from("forum_categories").select("*").order("name"),x.from("forum_topics").select("id, title, author_id, replies_count, last_reply_at, is_pinned").order("replies_count",{ascending:!1}).limit(6)]);b(t||[]),w(S||[])}catch(t){o({title:"Failed to load forums",description:t.message,variant:"destructive"})}finally{T(!1)}})()},[]);const _=async()=>{if(!(c!=null&&c.id))return o({title:"Login required",description:"Please login to create a topic."});if(!(!n.trim()||!d)){u(!0);try{const{error:s}=await x.from("forum_topics").insert([{title:n.trim(),category_id:d,author_id:c.id}]);if(s)throw s;o({title:"Topic created",description:"Your topic is now live."}),j(""),g(void 0)}catch(s){o({title:"Create topic failed",description:s.message,variant:"destructive"})}finally{u(!1)}}};return C?e.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:e.jsx(L,{className:"w-6 h-6 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Community Forums"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect, discuss, and learn with fellow entrepreneurs"})]}),e.jsxs(H,{children:[e.jsx(V,{asChild:!0,children:e.jsxs(m,{className:"btn-hero",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"New Topic"]})}),e.jsxs(q,{children:[e.jsx(z,{children:e.jsx(E,{children:"Create New Topic"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{children:"Title"}),e.jsx(M,{value:n,onChange:s=>j(s.target.value),placeholder:"What do you want to discuss?"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{children:"Category"}),e.jsxs(B,{value:d,onValueChange:s=>g(s),children:[e.jsx(U,{children:e.jsx(G,{placeholder:"Select a category"})}),e.jsx(J,{children:l.map(s=>e.jsx(R,{value:s.id,children:s.name},s.id))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{onClick:_,disabled:!n.trim()||!d||p,children:p?"Creating...":"Create"})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center",children:[e.jsx(f,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("p",{className:"text-2xl font-bold",children:l.reduce((s,t)=>s+t.topics_count,0)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Topics"})]})}),e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center",children:[e.jsx(k,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("p",{className:"text-2xl font-bold",children:l.length*100}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Members"})]})}),e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center",children:[e.jsx(Y,{className:"w-8 h-8 mx-auto mb-2 text-purple-500"}),e.jsx("p",{className:"text-2xl font-bold",children:h.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hot Topics"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Forum Categories"}),l.map(s=>e.jsx(i,{className:"card-hover cursor-pointer",children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx(f,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.topics_count," topics"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.posts_count," posts"]})]})]}),e.jsx(m,{variant:"outline",size:"sm",children:"Join"})]})})},s.id))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Trending Topics"}),e.jsxs(i,{children:[e.jsx(N,{children:e.jsx(v,{className:"text-lg",children:"Hot Discussions"})}),e.jsx(r,{className:"space-y-4",children:h.map(s=>e.jsxs("div",{className:"space-y-2 p-3 rounded-lg hover:bg-muted/50 cursor-pointer",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[s.is_pinned&&e.jsx(K,{className:"w-4 h-4 text-primary mt-0.5"}),e.jsx("h4",{className:"font-medium text-sm leading-tight",children:s.title})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s.replies_count," replies"]}),e.jsx("span",{children:s.last_reply_at?new Date(s.last_reply_at).toLocaleString("en-NG"):""})]})]},s.id))})]}),e.jsxs(i,{children:[e.jsx(N,{children:e.jsx(v,{className:"text-lg",children:"Active Members"})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-3",children:l.slice(0,3).map((s,t)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(I,{className:"w-8 h-8",children:[e.jsx(P,{src:void 0,alt:s.name}),e.jsx(F,{children:s.name.charAt(0)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium",children:[s.name," Moderator"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"active this week"})]})]},t))})})]})]})]})]})};export{te as default};
